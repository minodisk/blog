<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>I/O</title>
  <link href="/css/gisty.css" rel="stylesheet">

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', '{ [] [91 109 105 110 111 100 105 115 107 47 99 111 102 102 101 101 45 114 101 102 97 99 116 111 114 93 40 104 116 116 112 115 58 47 47 103 105 116 104 117 98 46 99 111 109 47 109 105 110 111 100 105 115 107 47 99 111 102 102 101 101 45 114 101 102 97 99 116 111 114 41 227 130 146 228 189 156 230 136 144 228 184 173 227 129 171 91 105 110 100 101 120 46 99 111 102 102 101 101 93 40 104 116 116 112 58 47 47 99 111 102 102 101 101 115 99 114 105 112 116 46 111 114 103 47 100 111 99 117 109 101 110 116 97 116 105 111 110 47 100 111 99 115 47 41 227 130 146 232 170 173 227 130 147 227 129 167 227 130 143 227 129 139 227 129 163 227 129 159 227 129 147 227 129 168 227 129 174 227 131 161 227 131 162 227 128 130 10 10 35 35 32 110 111 100 101 115 46 99 111 102 102 101 101 10 10 35 35 35 32 67 111 100 101 35 99 111 109 112 105 108 101 78 111 100 101 40 41 10 10 227 131 142 227 131 188 227 131 137 227 130 146 227 130 179 227 131 179 227 131 145 227 130 164 227 131 171 227 129 153 227 130 139 227 128 130 10 227 130 179 227 131 179 227 131 145 227 130 164 227 131 171 227 129 174 233 129 142 231 168 139 227 129 167 96 83 99 111 112 101 96 227 130 164 227 131 179 227 130 185 227 130 191 227 131 179 227 130 185 227 129 140 228 189 156 230 136 144 227 129 149 227 130 140 227 130 139 227 128 130 10 227 130 170 227 131 151 227 130 183 227 131 167 227 131 179 227 129 171 232 166 170 227 129 174 227 130 185 227 130 179 227 131 188 227 131 151 227 130 146 230 184 161 227 129 153 227 129 168 96 118 97 114 105 97 98 108 101 115 96 227 129 175 232 166 170 227 129 174 227 130 185 227 130 179 227 131 188 227 131 151 229 134 133 227 129 167 229 174 163 232 168 128 227 129 149 227 130 140 227 129 159 229 164 137 230 149 176 227 130 146 232 128 131 230 133 174 227 129 151 227 129 159 229 164 137 230 149 176 227 129 174 227 131 170 227 130 185 227 131 136 227 129 168 227 129 170 227 130 139 227 128 130 10 10 60 100 105 118 32 99 108 97 115 115 61 34 104 105 103 104 108 105 103 104 116 34 62 60 112 114 101 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 118 34 62 111 112 116 105 111 110 115 32 61 60 47 115 112 97 110 62 10 32 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 118 34 62 115 99 111 112 101 58 32 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 112 97 114 101 110 116 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 115 99 111 112 101 60 47 115 112 97 110 62 10 32 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 118 34 62 105 110 100 101 110 116 58 32 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 115 34 62 38 35 51 57 59 38 35 51 57 59 60 47 115 112 97 110 62 10 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 99 111 100 101 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 99 111 109 112 105 108 101 78 111 100 101 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 111 112 116 105 111 110 115 60 47 115 112 97 110 62 10 60 115 112 97 110 32 99 108 97 115 115 61 34 110 118 34 62 115 99 111 112 101 32 61 32 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 111 112 116 105 111 110 115 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 115 99 111 112 101 60 47 115 112 97 110 62 10 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 99 111 110 115 111 108 101 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 108 111 103 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 115 99 111 112 101 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 118 97 114 105 97 98 108 101 115 60 47 115 112 97 110 62 10 60 47 112 114 101 62 60 47 100 105 118 62 10 10 10 35 35 32 115 99 111 112 101 46 99 111 102 102 101 101 10 10 35 35 35 32 83 99 111 112 101 35 100 101 99 108 97 114 101 100 86 97 114 105 97 98 108 101 115 40 41 10 10 227 130 185 227 130 179 227 131 188 227 131 151 229 134 133 227 129 167 96 118 97 114 96 227 129 167 229 174 163 232 168 128 227 129 149 227 130 140 227 130 139 229 164 137 230 149 176 227 129 174 233 133 141 229 136 151 227 130 146 232 191 148 227 129 153 227 128 130 227 131 145 227 131 169 227 131 161 227 131 188 227 130 191 227 129 175 229 144 171 227 129 190 227 130 140 227 129 170 227 129 132 227 128 130 10 10 227 130 185 227 130 179 227 131 188 227 131 151 229 134 133 227 129 167 229 174 154 231 190 169 227 129 149 227 130 140 227 130 139 229 133 168 227 129 166 227 129 174 229 144 141 229 137 141 231 169 186 233 150 147 227 130 146 229 143 150 229 190 151 227 129 153 227 130 139 227 129 159 227 130 129 227 129 171 227 129 175 227 128 129 227 129 149 227 130 137 227 129 171 227 131 145 227 131 169 227 131 161 227 131 188 227 130 191 227 130 146 229 144 171 227 130 128 229 191 133 232 166 129 227 129 140 230 156 137 227 130 139 227 129 159 227 130 129 228 184 139 232 168 152 227 129 174 227 130 179 227 131 188 227 131 137 227 130 146 228 189 191 227 129 134 227 128 130 10 60 100 105 118 32 99 108 97 115 115 61 34 104 105 103 104 108 105 103 104 116 34 62 60 112 114 101 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 118 34 62 100 101 99 108 97 114 101 100 83 121 109 98 111 108 115 32 61 32 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 102 34 62 40 115 99 111 112 101 41 32 45 38 103 116 59 60 47 115 112 97 110 62 10 32 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 118 34 62 114 101 97 108 86 97 114 115 32 61 32 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 91 93 60 47 115 112 97 110 62 10 32 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 118 34 62 116 101 109 112 86 97 114 115 32 61 32 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 91 93 60 47 115 112 97 110 62 10 32 32 60 115 112 97 110 32 99 108 97 115 115 61 34 107 34 62 102 111 114 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 118 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 107 34 62 105 110 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 64 118 97 114 105 97 98 108 101 115 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 107 34 62 119 104 101 110 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 118 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 116 121 112 101 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 111 34 62 105 115 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 115 34 62 38 35 51 57 59 118 97 114 38 35 51 57 59 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 111 34 62 111 114 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 118 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 116 121 112 101 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 111 34 62 105 115 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 115 34 62 38 35 51 57 59 112 97 114 97 109 38 35 51 57 59 60 47 115 112 97 110 62 10 32 32 32 32 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 40 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 107 34 62 105 102 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 118 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 110 97 109 101 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 99 104 97 114 65 116 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 40 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 109 105 34 62 48 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 41 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 111 34 62 105 115 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 115 34 62 38 35 51 57 59 95 38 35 51 57 59 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 107 34 62 116 104 101 110 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 116 101 109 112 86 97 114 115 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 107 34 62 101 108 115 101 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 114 101 97 108 86 97 114 115 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 41 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 112 117 115 104 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 118 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 110 97 109 101 60 47 115 112 97 110 62 10 32 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 114 101 97 108 86 97 114 115 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 115 111 114 116 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 40 41 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 99 111 110 99 97 116 60 47 115 112 97 110 62 32 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 116 101 109 112 86 97 114 115 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 46 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 110 120 34 62 115 111 114 116 60 47 115 112 97 110 62 60 115 112 97 110 32 99 108 97 115 115 61 34 112 34 62 40 41 60 47 115 112 97 110 62 10 60 47 112 114 101 62 60 47 100 105 118 62 10 10] \n\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/minodisk\/coffee-refactor\x22\x3eminodisk\/coffee-refactor\x3c\/a\x3eを作成中に\x3ca href=\x22http:\/\/coffeescript.org\/documentation\/docs\/\x22\x3eindex.coffee\x3c\/a\x3eを読んでわかったことのメモ。\x3c\/p\x3e\n\n\x3ch2 id=\x22toc_0\x22\x3enodes.coffee\x3c\/h2\x3e\n\n\x3ch3 id=\x22toc_1\x22\x3eCode#compileNode()\x3c\/h3\x3e\n\n\x3cp\x3eノードをコンパイルする。\nコンパイルの過程で\x3ccode\x3eScope\x3c\/code\x3eインスタンスが作成される。\nオプションに親のスコープを渡すと\x3ccode\x3evariables\x3c\/code\x3eは親のスコープ内で宣言された変数を考慮した変数のリストとなる。\x3c\/p\x3e\n\n\x3cdiv class=\x22highlight\x22\x3e\x3cpre\x3e\x3cspan class=\x22nv\x22\x3eoptions =\x3c\/span\x3e\n  \x3cspan class=\x22nv\x22\x3escope: \x3c\/span\x3e\x3cspan class=\x22nx\x22\x3eparent\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3escope\x3c\/span\x3e\n  \x3cspan class=\x22nv\x22\x3eindent: \x3c\/span\x3e\x3cspan class=\x22s\x22\x3e\x26#39;\x26#39;\x3c\/span\x3e\n\x3cspan class=\x22nx\x22\x3ecode\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3ecompileNode\x3c\/span\x3e \x3cspan class=\x22nx\x22\x3eoptions\x3c\/span\x3e\n\x3cspan class=\x22nv\x22\x3escope = \x3c\/span\x3e\x3cspan class=\x22nx\x22\x3eoptions\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3escope\x3c\/span\x3e\n\x3cspan class=\x22nx\x22\x3econsole\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3elog\x3c\/span\x3e \x3cspan class=\x22nx\x22\x3escope\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3evariables\x3c\/span\x3e\n\x3c\/pre\x3e\x3c\/div\x3e\n\n\x3ch2 id=\x22toc_2\x22\x3escope.coffee\x3c\/h2\x3e\n\n\x3ch3 id=\x22toc_3\x22\x3eScope#declaredVariables()\x3c\/h3\x3e\n\n\x3cp\x3eスコープ内で\x3ccode\x3evar\x3c\/code\x3eで宣言される変数の配列を返す。パラメータは含まれない。\x3c\/p\x3e\n\n\x3cp\x3eスコープ内で定義される全ての名前空間を取得するためには、さらにパラメータを含む必要が有るため下記のコードを使う。\n\x3cdiv class=\x22highlight\x22\x3e\x3cpre\x3e\x3cspan class=\x22nv\x22\x3edeclaredSymbols = \x3c\/span\x3e\x3cspan class=\x22nf\x22\x3e(scope) -\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22nv\x22\x3erealVars = \x3c\/span\x3e\x3cspan class=\x22p\x22\x3e[]\x3c\/span\x3e\n  \x3cspan class=\x22nv\x22\x3etempVars = \x3c\/span\x3e\x3cspan class=\x22p\x22\x3e[]\x3c\/span\x3e\n  \x3cspan class=\x22k\x22\x3efor\x3c\/span\x3e \x3cspan class=\x22nx\x22\x3ev\x3c\/span\x3e \x3cspan class=\x22k\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22nx\x22\x3e@variables\x3c\/span\x3e \x3cspan class=\x22k\x22\x3ewhen\x3c\/span\x3e \x3cspan class=\x22nx\x22\x3ev\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22o\x22\x3eis\x3c\/span\x3e \x3cspan class=\x22s\x22\x3e\x26#39;var\x26#39;\x3c\/span\x3e \x3cspan class=\x22o\x22\x3eor\x3c\/span\x3e \x3cspan class=\x22nx\x22\x3ev\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22o\x22\x3eis\x3c\/span\x3e \x3cspan class=\x22s\x22\x3e\x26#39;param\x26#39;\x3c\/span\x3e\n    \x3cspan class=\x22p\x22\x3e(\x3c\/span\x3e\x3cspan class=\x22k\x22\x3eif\x3c\/span\x3e \x3cspan class=\x22nx\x22\x3ev\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3ename\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3echarAt\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e(\x3c\/span\x3e\x3cspan class=\x22mi\x22\x3e0\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e)\x3c\/span\x3e \x3cspan class=\x22o\x22\x3eis\x3c\/span\x3e \x3cspan class=\x22s\x22\x3e\x26#39;_\x26#39;\x3c\/span\x3e \x3cspan class=\x22k\x22\x3ethen\x3c\/span\x3e \x3cspan class=\x22nx\x22\x3etempVars\x3c\/span\x3e \x3cspan class=\x22k\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22nx\x22\x3erealVars\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e).\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3epush\x3c\/span\x3e \x3cspan class=\x22nx\x22\x3ev\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3ename\x3c\/span\x3e\n  \x3cspan class=\x22nx\x22\x3erealVars\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3esort\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e().\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3econcat\x3c\/span\x3e \x3cspan class=\x22nx\x22\x3etempVars\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e.\x3c\/span\x3e\x3cspan class=\x22nx\x22\x3esort\x3c\/span\x3e\x3cspan class=\x22p\x22\x3e()\x3c\/span\x3e\n\x3c\/pre\x3e\x3c\/div\x3e\x3c\/p\x3e\n minodisk\/coffee-refactorを作成中にindex.coffeeを読んでわかったことのメモ。 nodes.coffee Code#compileNode() ノードをコンパイルする。 コンパイルの過程でScopeインスタンスが作成される。 オプションに親のスコープを渡すとvariablesは親のスコープ内で宣言された変数を考慮した変数のリストとなる。 options = scope: parent.scope indent: \x26ldquo; code.compileNode options scope = options.scope console.log scope.variables scope.coffee Scope#declaredVariables() スコープ内でvarで宣言される変数の配列を返す。パラメータは含まれない。 スコープ内で定義される全ての名前空間を取得するためには、さらにパラメータを含む必要が有るため下記のコードを使う。 declaredSymbols = (scope) -\x26gt; realVars = [] tempVars = [] for v in @variables when v.type is \x26lsquo;var\x26rsquo; or v.type is \x26lsquo;param\x26rsquo; (if v.name.charAt(0) is \x26lsquo;_\x26rsquo; then tempVars else realVars).push v.name realVars.sort().concat tempVars.sort() \x3cnav id=\x22TableOfContents\x22\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22#toc_0\x22\x3enodes.coffee\x3c\/a\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22#toc_1\x22\x3eCode#compileNode()\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22#toc_2\x22\x3escope.coffee\x3c\/a\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22#toc_3\x22\x3eScope#declaredVariables()\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/nav\x3e true minodisk\/coffee-refactorを作成中にindex.coffeeを読んでわかったことのメモ。 \n  nodes.coffee  Code#compileNode()  ノードをコンパイルする。 コンパイルの過程でScopeインスタンスが作成される。 オプションに親のスコープを渡すとvariablesは親のスコープ内で宣言された変数を考慮した変数のリストとなる。 \n   options =   scope: parent.scope   indent: \x26ldquo; code.compileNode options scope = options.scope console.log scope.variables  \n  scope.coffee  Scope#declaredVariables()  スコープ内でvarで宣言される変数の配列を返す。パラメータは含まれない。 \n  スコープ内で定義される全ての名前空間を取得するためには、さらにパラメータを含む必要が有るため下記のコードを使う。  declaredSymbols = (scope) -\x26gt;   realVars = []   tempVars = []   for v in @variables when v.type is \x26lsquo;var\x26rsquo; or v.type is \x26lsquo;param\x26rsquo;     (if v.name.charAt(0) is \x26lsquo;_\x26rsquo; then tempVars else realVars).push v.name   realVars.sort().concat tempVars.sort()  \n  map[comments:true tags:[CoffeeScript]]  false 0001-01-01 00:00:00 \x2b0000 UTC [] 0xc2103fdd40  true post  [45 45 45 10 108 97 121 111 117 116 58 32 112 111 115 116 10 116 105 116 108 101 58 32 34 67 111 102 102 101 101 83 99 114 105 112 116 32 67 111 109 112 105 108 101 114 34 10 100 97 116 101 58 32 50 48 49 52 45 48 53 45 48 50 32 49 48 58 51 55 58 48 51 32 43 48 57 48 48 10 99 111 109 109 101 110 116 115 58 32 116 114 117 101 10 116 97 103 115 58 10 45 32 67 111 102 102 101 101 83 99 114 105 112 116 10 45 45 45 10] [] [] {56 100 1 0} {coffeescript-compiler.md html post\/} {0xc2101f4840 0xc2103c1b80} { 0xc21039e9e8 map[] CoffeeScript Compiler  [] map[] 0001-01-01 00:00:00 \x2b0000 UTC { -1} {   post}}}');
  ga('send', 'pageview');
</script>


</head>
<body>
  <div class="wrapper">
    <header class="header">
      <div class="image-container">
        <canvas class="image"></canvas>
      </div>
      <div class="title-container">
        <div class="title">
          <h1><a href="http://localhost:1313">I/O</a></h1>
        </div>
      </div>
    </header>
    <div class="body">

<article class="article">
  <h1 class="article-title"><a href="http://localhost:1313/post/coffeescript-compiler">CoffeeScript Compiler</a></h1>
  <p class="meta"><small>&nbsp;<i class="fa fa-calendar-o"></i> 0001-01-01</small></p> <hr/>
  <div class="article-content">
    

<p><a href="https://github.com/minodisk/coffee-refactor">minodisk/coffee-refactor</a>を作成中に<a href="http://coffeescript.org/documentation/docs/">index.coffee</a>を読んでわかったことのメモ。</p>

<h2 id="toc_0">nodes.coffee</h2>

<h3 id="toc_1">Code#compileNode()</h3>

<p>ノードをコンパイルする。
コンパイルの過程で<code>Scope</code>インスタンスが作成される。
オプションに親のスコープを渡すと<code>variables</code>は親のスコープ内で宣言された変数を考慮した変数のリストとなる。</p>

<div class="highlight"><pre><span class="nv">options =</span>
  <span class="nv">scope: </span><span class="nx">parent</span><span class="p">.</span><span class="nx">scope</span>
  <span class="nv">indent: </span><span class="s">&#39;&#39;</span>
<span class="nx">code</span><span class="p">.</span><span class="nx">compileNode</span> <span class="nx">options</span>
<span class="nv">scope = </span><span class="nx">options</span><span class="p">.</span><span class="nx">scope</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">variables</span>
</pre></div>

<h2 id="toc_2">scope.coffee</h2>

<h3 id="toc_3">Scope#declaredVariables()</h3>

<p>スコープ内で<code>var</code>で宣言される変数の配列を返す。パラメータは含まれない。</p>

<p>スコープ内で定義される全ての名前空間を取得するためには、さらにパラメータを含む必要が有るため下記のコードを使う。
<div class="highlight"><pre><span class="nv">declaredSymbols = </span><span class="nf">(scope) -&gt;</span>
  <span class="nv">realVars = </span><span class="p">[]</span>
  <span class="nv">tempVars = </span><span class="p">[]</span>
  <span class="k">for</span> <span class="nx">v</span> <span class="k">in</span> <span class="nx">@variables</span> <span class="k">when</span> <span class="nx">v</span><span class="p">.</span><span class="nx">type</span> <span class="o">is</span> <span class="s">&#39;var&#39;</span> <span class="o">or</span> <span class="nx">v</span><span class="p">.</span><span class="nx">type</span> <span class="o">is</span> <span class="s">&#39;param&#39;</span>
    <span class="p">(</span><span class="k">if</span> <span class="nx">v</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">is</span> <span class="s">&#39;_&#39;</span> <span class="k">then</span> <span class="nx">tempVars</span> <span class="k">else</span> <span class="nx">realVars</span><span class="p">).</span><span class="nx">push</span> <span class="nx">v</span><span class="p">.</span><span class="nx">name</span>
  <span class="nx">realVars</span><span class="p">.</span><span class="nx">sort</span><span class="p">().</span><span class="nx">concat</span> <span class="nx">tempVars</span><span class="p">.</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></p>

  </div>
</article>

<a href="https://twitter.com/share" class="twitter-share-button " data-size="small" data-count="none">Tweet</a>
<script>
!function(d,s,id){
  var js
  ,fjs=d.getElementsByTagName(s)[0]
  ,p=/^http:/.test(d.location)?'http':'https'
  ;
  if (!d.getElementById(id)) {
    js=d.createElement(s);
    js.id=id;
    js.src=p+'://platform.twitter.com/widgets.js';
    fjs.parentNode.insertBefore(js,fjs);
  }
}(document, 'script', 'twitter-wjs');
</script>


<section class="disqus container">
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'dsk-mn';
    var disqus_identifier = 'http:\/\/localhost:1313\/post\/coffeescript-compiler';
    var disqus_title = 'CoffeeScript Compiler';
    var disqus_url = 'http:\/\/localhost:1313\/post\/coffeescript-compiler';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


<div class="related-posts">
  <ul class="close-posts">
    
    <li class="prev">
      <h4 class="title"><a rel="prev" href="http://localhost:1313/post/install-node-canvas">Install node-canvas</a></h4>
      <span class="posted-date">Posted on 0001-01-01</span>
    </li>
    
    
    <li class="next">
      <h4 class="title"><a rel="next" href="http://localhost:1313/post/access-to-title-in-ie8">Access to title in IE8</a></h4>
      <span class="posted-date">Posted on 0001-01-01</span>
    </li>
    
  </ul>
</div>

      <footer class="footer">

      </footer>
    </div>
  </div>
<script>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>

